server {
    server_name localhost;
    listen 80 default_server;

    autoindex on;

    set $charset utf-8;

    charset $charset;

    set $rootdir /www;

    if ( $request_uri ~* ^/(dever_package\/manage|dever_package\/ui|dever_package\/script) ) {
        set $rootdir /share/lib/php;
    }
    root $rootdir;
    index index.php index.html;
    if ( $request_uri ~* /(applet\/content|applet_on\/content) ) {
            rewrite ^/(.*)/content/(.*) /$1/content/index.php?$2 last;
    }
    if ( $request_uri ~* /log\/data.add ) {
            rewrite ^/log/(.*?) /log/index.php?$1 last;
    }
    if ( $request_uri ~* /system/wechat ) {
            rewrite ^/system/wechat /system/index.php?m=payment&a=wechat_notify last;
    }
    if ( $request_uri ~* /grow/pay/notify ) {
            rewrite ^/grow/pay/notify/([0-9+]) /grow/pay/index.php?l=api.notify&account_id=$1 last;
    }
    location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
                # Uncomment to enable naxsi on this location
                # include /etc/nginx/naxsi.rules
    }

    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        # NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini

        # With php-cgi alone:
        #fastcgi_pass web-php7:9000;
        fastcgi_pass web-php5:9000;
        # With php-fpm:
        #fastcgi_pass unix:/var/run/php7-fpm.sock;
        fastcgi_index index.php;
        fastcgi_param  SCRIPT_FILENAME  $rootdir/$fastcgi_script_name;
        include fastcgi_params;
    }
}

#server {
    #server_name wx.shemic.com;
    #listen 80; # 或者 443，如果你使用 HTTPS 的话
    #ssl on; 是否启用加密连接
    #如果你使用 HTTPS，还需要填写 ssl_certificate 和 ssl_certificate_key

    #location / { # 如果你希望通过子路径访问，此处修改为子路径，注意以 / 开头并以 / 结束
        #proxy_pass http://wx.shemic.com:5000/;
    #}
#}
